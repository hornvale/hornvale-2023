name: Continuous Integration
on:
  push:
    branches:
      - main
  pull_request:

jobs:

  - name: Update local toolchain
    run: |
      rustup update;
      rustup component add clippy;

  - name: Toolchain info
    run: |
      cargo --version --verbose;
      rustc --version;
      cargo clippy --version;

  - name: Lint
    run: |
      cd hornvale;
      cargo fmt -- --check;
      cargo clippy -- -D warnings;         

  - name: Test
    run: |
      cd hornvale;
      cargo check;
      cargo test --all;

  - name: Build
    run: |
      cd hornvale;
      cargo build --release;
    